SELECT COUNT(DISTINCT utm_campaign)FROM page_visits; SELECT COUNT(DISTINCT utm_source)FROM page_visits; SELECT DISTINCT utm_campaign AS campaign, utm_source AS sourceFROM page_visitsORDER BY 2; SELECT DISTINCT(page_name) AS ‘Page name’FROM page_visits;WITH first_touch AS (SELECT MIN(timestamp) AS ‘first_touch_at’, utm_campaign, utm_source, user_idFROM page_visitsGROUP BY user_id)SELECT COUNT(*) as ‘total first touch’, utm_campaign as ‘Campaign’, utm_source AS ‘Source’ FROM first_touchGROUP BY 2ORDER BY 1 DESC;WITH first_touch AS (SELECT user_id, MIN(timestamp) as first_touch_atFROM page_visitsGROUP BY user_id)SELECT COUNT(*) AS ‘total first touch, pv.utm_source AS ‘Source’, pv.utm_campaign AS ‘Campaign’FROM first_touch ftJOIN page_visits pvON ft.user_id = pv.user_idAND ft.first_touch_at = pv.timestampGROUP BY 3ORDER BY 1 DESC; SELECT MIN(timestamp) AS ‘first_touch_at’, utm_campaign, utm_source, user_idFROM page_visitsWHERE utm_campaign LIKE ‘%paid%’ GROUP BY user_id; SELECT *FROM page_visitsWHERE user_id = 15060; WITH last_touch AS (SELECT MAX(timestamp) AS ‘last_touch_at’, utm_campaign, utm_source, user_idFROM page_visitsGROUP BY user_id)SELECT COUNT(*) AS ‘total last touch’, utm_campaign AS ‘Campaign’, utm_source AS ‘Source’FROM last_touch GROUP BY 2ORDER BY 1 DESC; WITH last_touch AS (SELECT user_id, MAX(timestamp) AS last_touch_atFROM page_visitsGROUP BY user_id)SELECT COUNT(*) AS ‘Total last touch’, pv.utm_source AS ‘Source’, pv.utm_campaign AS ‘Campaign’FROM last_touch ltJOIN page_visits pvON lt.user_id = pv.user_idAND lt.last_touch_at = pv.timestampGROUP BY 3ORDER BY 1 DESC;SELECT COUNT(DISTINCT user_id) AS ‘users who purchase’FROM page_visitsWHERE page_name = ‘4 - purchase’; WITH last_touch AS (SELECT MAX(timestamp) AS ‘last_touch_at’, utm_source, umm_campaign, user_idFROM page_visitsWHERE page_name = ‘4 - purchase’GROUP BY user_id)SELECT COUNT(*) AS ‘Total purchases’, utm_campaign AS ‘Campaign’, utm_source AS ‘Source’ From last_touchGROUP BY 2ORDER BY 1 DESC;SELECT page_name,COUNT(DISTINCT user_id)FROM page_visitsGROUP BY 1;